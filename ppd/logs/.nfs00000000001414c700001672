INFO:__main__:Proxy resolved KV addresses -> prefill: 127.0.0.1:14579, decode: 127.0.0.1:14580
[2025-12-24 00:37:05 -0600] [3623326] [INFO] Running on http://127.0.0.1:8000 (CTRL + C to quit)
INFO:hypercorn.error:Running on http://127.0.0.1:8000 (CTRL + C to quit)
INFO:__main__:[prefill] start request_id=___prefill_addr_127.0.0.1:14579___decode_addr_127.0.0.1:14580_54f23de5ae694258812b64458d45f6a3 url=http://localhost:8100/v1/completions
ERROR:__main__:Error processing request
Traceback (most recent call last):
  File "/net/projects2/ds3lab/zongzel/vllm/benchmarks/disagg_benchmarks/disagg_prefill_proxy_server.py", line 140, in _run_prefill
    async with (
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/client.py", line 1510, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/client.py", line 779, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/client.py", line 757, in _connect_and_send_request
    await resp.start(conn)
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/client_reqrep.py", line 539, in start
    message, payload = await protocol.read()  # type: ignore[union-attr]
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/streams.py", line 680, in read
    await self._waiter
aiohttp.client_exceptions.ServerDisconnectedError: Server disconnected

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/net/projects2/ds3lab/zongzel/vllm/benchmarks/disagg_benchmarks/disagg_prefill_proxy_server.py", line 222, in process_request
    await _run_prefill(request.path, prefill_request, headers, request_id)
  File "/net/projects2/ds3lab/zongzel/vllm/benchmarks/disagg_benchmarks/disagg_prefill_proxy_server.py", line 159, in _run_prefill
    raise RuntimeError(f"Prefill service unavailable at {url}") from exc
RuntimeError: Prefill service unavailable at http://localhost:8100/v1/completions
 * Serving Quart app 'disagg_prefill_proxy_server'
 * Debug mode: False
 * Please use an ASGI server (e.g. Hypercorn) directly in production
 * Running on http://127.0.0.1:8000 (CTRL + C to quit)
[2025-12-24 00:45:58 -0600] [3623326] [INFO] 127.0.0.1:45088 POST /v1/completions 1.1 500 34 530862709
INFO:__main__:[prefill] start request_id=___prefill_addr_127.0.0.1:14579___decode_addr_127.0.0.1:14580_d7d0bc5343ea462689379509be41d62d url=http://localhost:8100/v1/completions
ERROR:__main__:Error processing request
Traceback (most recent call last):
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/connector.py", line 1268, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 141, in start_connection
    raise OSError(first_errno, msg)
ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 8100, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 8100)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/net/projects2/ds3lab/zongzel/vllm/benchmarks/disagg_benchmarks/disagg_prefill_proxy_server.py", line 140, in _run_prefill
    async with (
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/client.py", line 1510, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/client.py", line 779, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/client.py", line 734, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/connector.py", line 1581, in _create_direct_connection
    raise last_exc
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/connector.py", line 1550, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/connector.py", line 1291, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:8100 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 8100, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 8100)]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/net/projects2/ds3lab/zongzel/vllm/benchmarks/disagg_benchmarks/disagg_prefill_proxy_server.py", line 222, in process_request
    await _run_prefill(request.path, prefill_request, headers, request_id)
  File "/net/projects2/ds3lab/zongzel/vllm/benchmarks/disagg_benchmarks/disagg_prefill_proxy_server.py", line 159, in _run_prefill
    raise RuntimeError(f"Prefill service unavailable at {url}") from exc
RuntimeError: Prefill service unavailable at http://localhost:8100/v1/completions
[2025-12-24 00:45:59 -0600] [3623326] [INFO] 127.0.0.1:53088 POST /v1/completions 1.1 500 34 26597
INFO:__main__:[prefill] start request_id=___prefill_addr_127.0.0.1:14579___decode_addr_127.0.0.1:14580_83ecc520e95740a1ab1302c0ddd22c2b url=http://localhost:8100/v1/completions
ERROR:__main__:Error processing request
Traceback (most recent call last):
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/connector.py", line 1268, in _wrap_create_connection
    sock = await aiohappyeyeballs.start_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 141, in start_connection
    raise OSError(first_errno, msg)
ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 8100, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 8100)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/net/projects2/ds3lab/zongzel/vllm/benchmarks/disagg_benchmarks/disagg_prefill_proxy_server.py", line 140, in _run_prefill
    async with (
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/client.py", line 1510, in __aenter__
    self._resp: _RetType = await self._coro
                           ^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/client.py", line 779, in _request
    resp = await handler(req)
           ^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/client.py", line 734, in _connect_and_send_request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/connector.py", line 642, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/connector.py", line 1209, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/connector.py", line 1581, in _create_direct_connection
    raise last_exc
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/connector.py", line 1550, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zongzel/.conda/envs/vllm-ppd/lib/python3.11/site-packages/aiohttp/connector.py", line 1291, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:8100 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 8100, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 8100)]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/net/projects2/ds3lab/zongzel/vllm/benchmarks/disagg_benchmarks/disagg_prefill_proxy_server.py", line 222, in process_request
    await _run_prefill(request.path, prefill_request, headers, request_id)
  File "/net/projects2/ds3lab/zongzel/vllm/benchmarks/disagg_benchmarks/disagg_prefill_proxy_server.py", line 159, in _run_prefill
    raise RuntimeError(f"Prefill service unavailable at {url}") from exc
RuntimeError: Prefill service unavailable at http://localhost:8100/v1/completions
[2025-12-24 00:45:59 -0600] [3623326] [INFO] 127.0.0.1:53092 POST /v1/completions 1.1 500 34 6957
